<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>ğŸ” Admin Â· LÃ¬ XÃ¬ Control Panel</title>
<meta name="robots" content="noindex,nofollow"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;700&family=Noto+Sans:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet"/>
<style>
:root{--bg:#0b0c14;--card:#11121f;--hover:#181929;--border:rgba(255,255,255,.07);--bg:rgba(212,160,23,.35);--border-red:rgba(192,57,43,.4);--red:#c0392b;--red2:#e74c3c;--gold:#d4a017;--gold2:#f1c40f;--gold3:#ffd700;--txt:#e8e8f0;--txt2:#8888a0;--txt3:#44445a;--green:#2ecc71;--blue:#3498db;--purple:#9b59b6;--sw:265px;--hh:64px;--r:14px}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}html{font-size:15px}
body{font-family:'Noto Sans',sans-serif;background:#0b0c14;color:var(--txt);min-height:100vh;overflow-x:hidden}
/* LOGIN */
#ls{position:fixed;inset:0;background:linear-gradient(135deg,#0b0c14,#15162a,#0e0f1c);display:flex;align-items:center;justify-content:center;z-index:9999;transition:opacity .5s,visibility .5s}
#ls.hidden{opacity:0;visibility:hidden;pointer-events:none}
.lbox{background:#11121f;border:1px solid rgba(212,160,23,.35);border-radius:24px;padding:52px 46px;width:min(420px,92vw);text-align:center;box-shadow:0 40px 80px rgba(0,0,0,.7),inset 0 1px 0 rgba(255,255,255,.06);animation:lap .6s cubic-bezier(.22,1,.36,1) both}
@keyframes lap{from{opacity:0;transform:translateY(40px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}
.llogo{font-size:3.5rem;margin-bottom:18px;display:block;animation:lpu 2s ease-in-out infinite}
@keyframes lpu{0%,100%{filter:drop-shadow(0 0 8px rgba(255,215,0,.4))}50%{filter:drop-shadow(0 0 22px rgba(255,215,0,.9))}}
.ltit{font-family:'Noto Serif',serif;font-size:1.6rem;color:var(--gold3);margin-bottom:5px}
.lsub2{font-size:.78rem;color:var(--txt2);letter-spacing:3px;text-transform:uppercase;margin-bottom:32px}
.lf{margin-bottom:14px;text-align:left}
.lf label{display:block;font-size:.73rem;color:var(--txt2);letter-spacing:2px;text-transform:uppercase;margin-bottom:6px}
.lf input{width:100%;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);border-radius:10px;padding:13px 15px;color:var(--txt);font-family:'JetBrains Mono',monospace;font-size:.95rem;outline:none;transition:border-color .2s,box-shadow .2s}
.lf input:focus{border-color:var(--gold);box-shadow:0 0 0 3px rgba(212,160,23,.12)}
.lf input::placeholder{color:var(--txt3)}
.lerr{color:var(--red2);font-size:.82rem;margin-bottom:10px;min-height:20px}
.lerr.sh{animation:shk .3s ease}
@keyframes shk{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}
.lbtn{width:100%;background:linear-gradient(135deg,var(--red),var(--red2));color:#fff;border:none;padding:14px;border-radius:10px;font-size:1rem;font-weight:700;cursor:pointer;letter-spacing:1px;transition:all .25s;margin-top:4px;box-shadow:0 4px 20px rgba(192,57,43,.4)}
.lbtn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(192,57,43,.55)}
.lback{margin-top:18px;font-size:.82rem;color:var(--txt2)}.lback a{color:var(--gold);text-decoration:none}
/* LAYOUT */
#app{display:none;min-height:100vh}#app.on{display:flex}
.sb{width:var(--sw);background:#11121f;border-right:1px solid rgba(255,255,255,.07);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:100;overflow-y:auto}
.sb-logo{padding:22px 22px 18px;border-bottom:1px solid rgba(255,255,255,.07);display:flex;align-items:center;gap:11px}
.sb-logo .ico{font-size:1.75rem}.sb-logo .nm{font-family:'Noto Serif',serif;font-size:1.02rem;color:var(--gold3);line-height:1.2}
.sb-logo .su{font-size:.65rem;color:var(--txt2);letter-spacing:2px;text-transform:uppercase}
/* Real-time indicator */
.rt-dot{display:inline-block;width:7px;height:7px;border-radius:50%;background:var(--green);margin-right:5px;animation:blink 1.5s ease-in-out infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
.sb-nav{padding:14px 0;flex:1}
.ns{padding:0 10px;margin-bottom:6px}
.ns-lbl{font-size:.63rem;color:var(--txt3);letter-spacing:3px;text-transform:uppercase;padding:7px 12px 5px;display:block}
.nl{display:flex;align-items:center;gap:11px;padding:10px 13px;border-radius:10px;color:var(--txt2);font-size:.88rem;transition:all .2s;cursor:pointer;border:none;background:none;width:100%;text-align:left}
.nl:hover{background:var(--hover);color:var(--txt)}.nl.active{background:rgba(192,57,43,.15);color:var(--gold)}
.nl .ni{font-size:1.05rem;width:20px;text-align:center}
.nl .nb{margin-left:auto;background:var(--red);color:#fff;font-size:.63rem;padding:2px 7px;border-radius:20px;font-weight:700}
.nl .nb.green{background:var(--green)}
.sb-foot{padding:14px 20px;border-top:1px solid rgba(255,255,255,.07)}
.sb-usr{display:flex;align-items:center;gap:9px}
.av{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--red),var(--gold));display:flex;align-items:center;justify-content:center;font-size:.95rem;flex-shrink:0}
.un{font-size:.86rem;color:var(--txt);font-weight:600}.ur{font-size:.7rem;color:var(--txt2)}
.lout{margin-left:auto;background:none;border:none;cursor:pointer;font-size:1.05rem;opacity:.5;transition:opacity .2s}.lout:hover{opacity:1}
.mc{margin-left:var(--sw);flex:1;display:flex;flex-direction:column;min-height:100vh}
.topbar{height:var(--hh);background:#11121f;border-bottom:1px solid rgba(255,255,255,.07);display:flex;align-items:center;padding:0 28px;position:sticky;top:0;z-index:50;gap:18px}
.tb-tit{font-family:'Noto Serif',serif;font-size:1.12rem;color:var(--txt);flex:1}
.tb-acts{display:flex;gap:9px;align-items:center}
.badge-a{background:rgba(192,57,43,.15);border:1px solid rgba(192,57,43,.4);color:var(--red2);padding:5px 13px;border-radius:20px;font-size:.76rem;font-weight:600;letter-spacing:1px}
.rt-badge{background:rgba(46,204,113,.12);border:1px solid rgba(46,204,113,.25);color:var(--green);padding:5px 13px;border-radius:20px;font-size:.76rem;font-weight:600;display:flex;align-items:center;gap:5px}
.ibtn{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);color:var(--txt2);width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:.95rem;transition:all .2s;text-decoration:none}
.ibtn:hover{background:var(--hover);color:var(--txt)}
.ca{padding:28px;flex:1}
.tab{display:none}.tab.on{display:block}
/* METRICS */
.mg{display:grid;grid-template-columns:repeat(auto-fit,minmax(175px,1fr));gap:14px;margin-bottom:20px}
.mc2{background:#11121f;border:1px solid rgba(255,255,255,.07);border-radius:var(--r);padding:18px 20px;position:relative;overflow:hidden;transition:all .25s;cursor:default}
.mc2:hover{border-color:rgba(255,255,255,.13);transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,.3)}
.mc2::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;border-radius:var(--r) var(--r) 0 0}
.mc2.gold::before{background:linear-gradient(90deg,var(--gold),var(--gold3))}.mc2.red::before{background:linear-gradient(90deg,var(--red),var(--red2))}.mc2.green::before{background:linear-gradient(90deg,#27ae60,var(--green))}.mc2.blue::before{background:linear-gradient(90deg,#2980b9,var(--blue))}.mc2.purple::before{background:linear-gradient(90deg,#8e44ad,var(--purple))}.mc2.teal::before{background:linear-gradient(90deg,#16a085,#1abc9c)}
.mc2-ico{font-size:1.4rem;margin-bottom:9px;display:block}
.mc2-val{font-family:'Noto Serif',serif;font-size:1.9rem;font-weight:700;color:var(--txt);line-height:1;margin-bottom:3px;transition:all .3s}
.mc2-lbl{font-size:.73rem;color:var(--txt2);letter-spacing:1px;text-transform:uppercase}
.mc2-sub{position:absolute;top:16px;right:16px;font-size:.7rem;color:var(--txt3);background:rgba(255,255,255,.04);padding:2px 9px;border-radius:20px;border:1px solid rgba(255,255,255,.06)}
.mc2-trend{font-size:.72rem;margin-top:5px}
.mc2-trend.up{color:var(--green)}.mc2-trend.dn{color:var(--red2)}
/* LIVE FEED */
.live-feed{background:#11121f;border:1px solid rgba(255,255,255,.07);border-radius:var(--r);overflow:hidden;margin-bottom:20px}
.live-head{padding:16px 20px;border-bottom:1px solid rgba(255,255,255,.07);display:flex;align-items:center;justify-content:space-between}
.live-title{font-family:'Noto Serif',serif;font-size:.95rem;color:var(--txt);display:flex;align-items:center;gap:8px}
.live-scroll{max-height:220px;overflow-y:auto;padding:8px 0}
.live-item{display:flex;align-items:center;gap:12px;padding:9px 20px;border-bottom:1px solid rgba(255,255,255,.03);animation:fadeSlide .4s ease;transition:background .15s}
.live-item:hover{background:var(--hover)}
@keyframes fadeSlide{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
.live-item:last-child{border-bottom:none}
.li-ico{font-size:1.2rem;flex-shrink:0}
.li-info{flex:1}
.li-main{font-size:.85rem;color:var(--txt);font-weight:600}
.li-sub{font-size:.72rem;color:var(--txt3);margin-top:1px}
.li-val{font-family:'JetBrains Mono',monospace;font-size:.9rem;font-weight:700;flex-shrink:0}
.li-time{font-size:.7rem;color:var(--txt3);flex-shrink:0;text-align:right}
/* TABLES */
.tw{background:#11121f;border:1px solid rgba(255,255,255,.07);border-radius:var(--r);overflow:hidden;margin-bottom:20px}
.th{padding:16px 20px;border-bottom:1px solid rgba(255,255,255,.07);display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.th-t{font-family:'Noto Serif',serif;font-size:.93rem;color:var(--txt);display:flex;align-items:center;gap:7px}
.th-c{display:flex;gap:9px;align-items:center}
.si{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);border-radius:8px;padding:7px 12px;color:var(--txt);font-size:.8rem;outline:none;transition:border-color .2s;width:170px}
.si:focus{border-color:var(--gold)}.si::placeholder{color:var(--txt3)}
.fs{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);border-radius:8px;padding:7px 11px;color:var(--txt);font-size:.8rem;outline:none;cursor:pointer}
.fs option{background:#11121f}
.dt{width:100%;border-collapse:collapse;font-size:.85rem}
.dt th{padding:10px 18px;text-align:left;font-size:.68rem;color:var(--txt3);letter-spacing:2px;text-transform:uppercase;border-bottom:1px solid rgba(255,255,255,.07);background:rgba(255,255,255,.015);font-weight:600}
.dt td{padding:12px 18px;border-bottom:1px solid rgba(255,255,255,.05);color:var(--txt2);transition:background .15s}
.dt tr:last-child td{border-bottom:none}.dt tbody tr:hover td{background:var(--hover)}
.badge{display:inline-flex;align-items:center;gap:3px;padding:3px 10px;border-radius:20px;font-size:.7rem;font-weight:600}
.bo{background:rgba(46,204,113,.12);color:var(--green);border:1px solid rgba(46,204,113,.2)}
.bp{background:rgba(212,160,23,.12);color:var(--gold2);border:1px solid rgba(212,160,23,.2)}
.bs{background:rgba(192,57,43,.15);color:var(--red2);border:1px solid rgba(192,57,43,.25)}
.bn{background:rgba(136,136,160,.1);color:var(--txt2);border:1px solid rgba(255,255,255,.07)}
/* CHARTS */
.cg{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:20px}
@media(max-width:900px){.cg{grid-template-columns:1fr}}
.cc{background:#11121f;border:1px solid rgba(255,255,255,.07);border-radius:var(--r);padding:20px}
.cc-t{font-family:'Noto Serif',serif;font-size:.92rem;color:var(--txt);margin-bottom:16px;display:flex;align-items:center;gap:7px}
.brow{margin-bottom:11px}
.blr{display:flex;justify-content:space-between;margin-bottom:4px;font-size:.78rem}
.blt{color:var(--txt2)}.blv{color:var(--txt);font-weight:600;font-family:'JetBrains Mono',monospace}
.btr{height:7px;background:rgba(255,255,255,.05);border-radius:4px;overflow:hidden}
.bf{height:100%;border-radius:4px;transition:width 1s cubic-bezier(.22,1,.36,1);min-width:3px}
/* CONFIG */
.cfg-g{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:20px}
@media(max-width:860px){.cfg-g{grid-template-columns:1fr}}
.cfg-c{background:#11121f;border:1px solid rgba(255,255,255,.07);border-radius:var(--r);padding:22px}
.cfg-t{font-family:'Noto Serif',serif;font-size:.95rem;color:var(--txt);margin-bottom:16px;display:flex;align-items:center;gap:7px;border-bottom:1px solid rgba(255,255,255,.06);padding-bottom:11px}
.cfg-r{display:flex;align-items:center;justify-content:space-between;padding:9px 0;border-bottom:1px solid rgba(255,255,255,.04)}
.cfg-r:last-child{border-bottom:none}
.cfg-l{font-size:.86rem;color:var(--txt2)}
.cfg-v{font-family:'JetBrains Mono',monospace;font-size:.86rem;color:var(--gold);background:rgba(212,160,23,.08);padding:3px 10px;border-radius:6px;border:1px solid rgba(212,160,23,.2)}
.inp{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.07);border-radius:8px;padding:7px 12px;color:var(--txt);font-family:'JetBrains Mono',monospace;font-size:.88rem;width:88px;outline:none;text-align:center;transition:border-color .2s}
.inp:focus{border-color:var(--gold)}.inp-lg{width:160px;text-align:left}
/* Ratio */
.rt{width:100%;border-collapse:collapse}
.rt td{padding:7px 5px;vertical-align:middle}
.rl{font-family:'JetBrains Mono',monospace;font-size:.8rem;color:var(--txt2);width:38px}
.rn{font-family:'JetBrains Mono',monospace;font-size:.8rem;color:var(--gold3);width:26px;text-align:right}
.rp{font-size:.72rem;color:var(--txt3);width:36px;text-align:right}
input[type=range]{-webkit-appearance:none;width:100%;height:5px;border-radius:3px;background:rgba(255,255,255,.08);outline:none}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:var(--gold);cursor:pointer;border:2px solid var(--gold3)}
/* Toggle */
.tgr{display:flex;align-items:center;gap:11px;padding:9px 0;border-bottom:1px solid rgba(255,255,255,.04)}
.tgr:last-child{border-bottom:none}
.tgl{font-size:.86rem;color:var(--txt2);flex:1}
.sw{position:relative;width:40px;height:21px;flex-shrink:0}
.sw input{opacity:0;width:0;height:0}
.sli{position:absolute;inset:0;background:rgba(255,255,255,.1);border-radius:21px;cursor:pointer;transition:background .3s}
.sli::before{content:'';position:absolute;left:3px;top:3px;width:15px;height:15px;background:#fff;border-radius:50%;transition:transform .3s}
input:checked+.sli{background:var(--red)}input:checked+.sli::before{transform:translateX(19px)}
/* Action btns */
.ab{display:inline-flex;align-items:center;gap:7px;padding:9px 18px;border-radius:9px;border:none;cursor:pointer;font-family:'Noto Sans',sans-serif;font-size:.83rem;font-weight:600;transition:all .2s;width:100%;justify-content:center;margin-top:10px}
.ar{background:rgba(192,57,43,.15);color:var(--red2);border:1px solid rgba(192,57,43,.3)}.ar:hover{background:rgba(192,57,43,.3)}
.ag{background:rgba(212,160,23,.12);color:var(--gold);border:1px solid rgba(212,160,23,.25)}.ag:hover{background:rgba(212,160,23,.25)}
.agr{background:rgba(46,204,113,.12);color:var(--green);border:1px solid rgba(46,204,113,.25)}.agr:hover{background:rgba(46,204,113,.25)}
.abl{background:rgba(52,152,219,.12);color:var(--blue);border:1px solid rgba(52,152,219,.25)}.abl:hover{background:rgba(52,152,219,.25)}
/* Save bar */
.svb{position:sticky;bottom:0;background:rgba(11,12,20,.94);backdrop-filter:blur(14px);border-top:1px solid rgba(212,160,23,.3);padding:14px 28px;display:none;align-items:center;justify-content:space-between;gap:14px;z-index:200}
.svb.show{display:flex}.svb-hint{font-size:.83rem;color:var(--gold2)}
.svb-acts{display:flex;gap:9px}
.svbtn{padding:9px 22px;border-radius:9px;border:none;cursor:pointer;font-family:'Noto Sans',sans-serif;font-size:.86rem;font-weight:700;transition:all .2s}
.svbtn-s{background:linear-gradient(135deg,var(--red),var(--red2));color:#fff;box-shadow:0 3px 12px rgba(192,57,43,.4)}.svbtn-s:hover{transform:translateY(-2px)}
.svbtn-d{background:rgba(255,255,255,.06);color:var(--txt2);border:1px solid rgba(255,255,255,.07)}.svbtn-d:hover{background:rgba(255,255,255,.1)}
/* Special cards */
.sp-g{display:grid;grid-template-columns:repeat(auto-fill,minmax(185px,1fr));gap:11px}
.sp-c{background:rgba(192,57,43,.08);border:1px solid rgba(192,57,43,.22);border-radius:10px;padding:13px 15px;transition:all .2s}
.sp-c:hover{border-color:rgba(192,57,43,.45);transform:translateY(-2px)}
.sp-n{font-size:.68rem;color:var(--txt3);margin-bottom:4px}
.sp-d{font-size:.82rem;color:var(--txt2);margin-bottom:3px}
.sp-r{font-family:'Noto Serif',serif;font-size:1.4rem;font-weight:700;color:var(--gold3)}
.sp-s{margin-top:6px}
/* Progress ring */
.prog-ring{display:flex;align-items:center;justify-content:center;padding:20px}
/* Toast */
.toast{position:fixed;bottom:22px;right:22px;background:#11121f;border:1px solid rgba(255,255,255,.07);border-radius:12px;padding:12px 17px;font-size:.86rem;color:var(--txt);box-shadow:0 8px 30px rgba(0,0,0,.5);z-index:9999;transform:translateX(130%);transition:transform .4s cubic-bezier(.22,1,.36,1);display:flex;align-items:center;gap:9px;min-width:220px}
.toast.show{transform:translateX(0)}.toast.s{border-left:3px solid var(--green)}.toast.e{border-left:3px solid var(--red2)}.toast.i{border-left:3px solid var(--gold)}
/* Notification bell */
.notif-badge{position:relative}
.notif-count{position:absolute;top:-5px;right:-5px;background:var(--red2);color:#fff;font-size:.6rem;width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700}
/* Scrollbar */
::-webkit-scrollbar{width:4px;height:4px}::-webkit-scrollbar-track{background:#0b0c14}::-webkit-scrollbar-thumb{background:rgba(255,255,255,.08);border-radius:3px}
@media(max-width:768px){:root{--sw:0}.sb{transform:translateX(-265px)}.sb.open{transform:translateX(0);width:265px}.mc{margin-left:0}.ca{padding:16px 13px}}
</style>
</head>
<body>
<!-- LOGIN -->
<div id="ls">
  <div class="lbox">
    <span class="llogo">ğŸ”</span>
    <h1 class="ltit">Admin Control Panel</h1>
    <p class="lsub2">LÃ¬ XÃ¬ Táº¿t Â· Real-time Dashboard</p>
    <form id="lf" novalidate>
      <div class="lf"><label for="lu">TÃªn Ä‘Äƒng nháº­p</label><input type="text" id="lu" placeholder="admin" autocomplete="username" required/></div>
      <div class="lf"><label for="lp">Máº­t kháº©u</label><input type="password" id="lp" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" required/></div>
      <p class="lerr" id="lerr" role="alert"></p>
      <button type="submit" class="lbtn">ğŸ”“ ÄÄƒng Nháº­p</button>
    </form>
    <p class="lback">â† <a href="/">Quay vá» trang chÆ¡i</a></p>
  </div>
</div>
<!-- APP -->
<div id="app">
  <aside class="sb" id="sb">
    <div class="sb-logo">
      <span class="ico">ğŸ§§</span>
      <div><div class="nm">LÃ¬ XÃ¬ Admin</div><div class="su"><span class="rt-dot"></span>Real-time</div></div>
    </div>
    <nav class="sb-nav">
      <div class="ns">
        <span class="ns-lbl">Tá»•ng quan</span>
        <button class="nl active" data-tab="overview"><span class="ni">ğŸ“Š</span><span class="nlbl">Dashboard</span></button>
        <button class="nl" data-tab="live"><span class="ni">ğŸ”´</span><span class="nlbl">Live Feed</span><span class="nb green" id="nb-live">0</span></button>
        <button class="nl" data-tab="envelopes"><span class="ni">ğŸ§§</span><span class="nlbl">Phong bÃ¬</span><span class="nb" id="nb-spec">2</span></button>
      </div>
      <div class="ns">
        <span class="ns-lbl">âš™ï¸ Cáº¥u hÃ¬nh</span>
        <button class="nl" data-tab="cfg-ratio"><span class="ni">ğŸ²</span><span class="nlbl">Tá»‰ lá»‡ má»‡nh giÃ¡</span></button>
        <button class="nl" data-tab="cfg-special"><span class="ni">â­</span><span class="nlbl">Má»‡nh giÃ¡ Ä‘áº·c biá»‡t</span></button>
        <button class="nl" data-tab="cfg-game"><span class="ni">ğŸ®</span><span class="nlbl">CÃ i Ä‘áº·t game</span></button>
      </div>
      <div class="ns">
        <span class="ns-lbl">BÃ¡o cÃ¡o</span>
        <button class="nl" data-tab="analytics"><span class="ni">ğŸ“ˆ</span><span class="nlbl">Thá»‘ng kÃª</span></button>
        <button class="nl" data-tab="log"><span class="ni">ğŸ“‹</span><span class="nlbl">Lá»‹ch sá»­ bá»‘c</span></button>
        <button class="nl" data-tab="notify"><span class="ni">ğŸ””</span><span class="nlbl">ThÃ´ng bÃ¡o</span><span class="nb" id="nb-notif">0</span></button>
      </div>
    </nav>
    <div class="sb-foot">
      <div class="sb-usr">
        <div class="av">A</div>
        <div><div class="un">Admin</div><div class="ur">Quáº£n trá»‹ viÃªn</div></div>
        <button class="lout" id="logout-btn" title="ÄÄƒng xuáº¥t">â»</button>
      </div>
    </div>
  </aside>
  <main class="mc">
    <div class="topbar">
      <h2 class="tb-tit" id="tb-tit">Dashboard</h2>
      <div class="tb-acts">
        <div class="rt-badge"><span class="rt-dot"></span>LIVE</div>
        <span class="badge-a">ğŸ”’ ADMIN</span>
        <button class="ibtn" id="refresh-btn" title="LÃ m má»›i">â†º</button>
        <button class="ibtn" id="export-btn" title="Xuáº¥t CSV">ğŸ“¥</button>
        <a class="ibtn" href="/" target="_blank" title="Trang ngÆ°á»i chÆ¡i">ğŸ </a>
      </div>
    </div>
    <div class="ca">

      <!-- OVERVIEW -->
      <section class="tab on" id="tab-overview">
        <div class="mg" id="metrics-grid"><!-- JS --></div>
        <div class="cg">
          <div class="cc"><div class="cc-t">ğŸ“Š PhÃ¢n phá»‘i má»‡nh giÃ¡</div><div id="c-dist"></div></div>
          <div class="cc"><div class="cc-t">ğŸ¯ Tiáº¿n Ä‘á»™ má»Ÿ</div><div id="c-prog"></div></div>
        </div>
        <div class="tw">
          <div class="th"><div class="th-t">â­ Ã” Äáº·c Biá»‡t</div></div>
          <div style="padding:16px 20px"><div class="sp-g" id="sp-cards"></div></div>
        </div>
      </section>

      <!-- LIVE FEED -->
      <section class="tab" id="tab-live">
        <div class="mg">
          <div class="mc2 green"><span class="mc2-ico">ğŸ”“</span><div class="mc2-val" id="lf-opened">0</div><div class="mc2-lbl">Vá»«a má»Ÿ (session)</div></div>
          <div class="mc2 gold"><span class="mc2-ico">â±</span><div class="mc2-val" id="lf-last">â€”</div><div class="mc2-lbl">Láº§n cuá»‘i bá»‘c</div></div>
          <div class="mc2 blue"><span class="mc2-ico">ğŸŒ</span><div class="mc2-val" id="lf-active">1</div><div class="mc2-lbl">PhiÃªn hoáº¡t Ä‘á»™ng</div></div>
          <div class="mc2 red"><span class="mc2-ico">ğŸ”¥</span><div class="mc2-val" id="lf-rate">0/ph</div><div class="mc2-lbl">Tá»‘c Ä‘á»™ bá»‘c</div></div>
        </div>
        <div class="live-feed">
          <div class="live-head">
            <div class="live-title">ğŸ”´ <span>Live Events</span></div>
            <button class="ibtn" onclick="clearEvents()">ğŸ—‘</button>
          </div>
          <div class="live-scroll" id="live-scroll"><!-- JS --></div>
        </div>
        <div class="tw">
          <div class="th"><div class="th-t">ğŸ“¡ Hoáº¡t Ä‘á»™ng theo giá»</div></div>
          <div style="padding:16px 20px"><div id="hourly-chart"></div></div>
        </div>
      </section>

      <!-- ENVELOPES -->
      <section class="tab" id="tab-envelopes">
        <div class="tw">
          <div class="th">
            <div class="th-t">ğŸ§§ Danh sÃ¡ch phong bÃ¬</div>
            <div class="th-c">
              <input type="search" class="si" id="env-search" placeholder="TÃ¬m..."/>
              <select class="fs" id="env-filter">
                <option value="all">Táº¥t cáº£</option><option value="opened">ÄÃ£ má»Ÿ</option>
                <option value="pending">ChÆ°a má»Ÿ</option><option value="special">Äáº·c biá»‡t</option>
              </select>
            </div>
          </div>
          <table class="dt"><thead><tr><th>ID</th><th>Loáº¡i</th><th>Hiá»ƒn thá»‹</th><th>Thá»±c táº¿</th><th>Tráº¡ng thÃ¡i</th><th>Thá»i gian</th><th>Thao tÃ¡c</th></tr></thead>
          <tbody id="env-tbody"></tbody></table>
        </div>
      </section>

      <!-- CONFIG RATIO -->
      <section class="tab" id="tab-cfg-ratio">
        <div class="cfg-c" style="margin-bottom:16px">
          <div class="cfg-t">ğŸ² Tá»‰ lá»‡ phÃ¢n phá»‘i má»‡nh giÃ¡ hiá»ƒn thá»‹</div>
          <p style="font-size:.82rem;color:var(--txt2);margin-bottom:16px;line-height:1.7">KÃ©o slider Ä‘iá»u chá»‰nh sá»‘ lÆ°á»£ng tá»«ng má»‡nh giÃ¡. Tá»•ng = tá»•ng sá»‘ Ã´ game.</p>
          <table class="rt" id="ratio-tbl"></table>
          <div style="margin-top:14px;padding:11px 15px;background:rgba(212,160,23,.06);border:1px solid rgba(212,160,23,.2);border-radius:10px;display:flex;align-items:center;justify-content:space-between">
            <span style="font-size:.83rem;color:var(--txt2)">Tá»•ng sá»‘ Ã´:</span>
            <span style="font-family:'JetBrains Mono',monospace;font-size:1.05rem;font-weight:700;color:var(--gold3)" id="ratio-tot">20</span>
          </div>
        </div>
        <div class="cfg-c" style="margin-bottom:16px">
          <div class="cfg-t">ğŸ“ Xem trÆ°á»›c phÃ¢n phá»‘i</div>
          <div id="ratio-preview"></div>
        </div>
        <button class="ab agr" id="save-ratio-btn">ğŸ’¾ LÆ°u tá»‰ lá»‡ má»‡nh giÃ¡</button>
      </section>

      <!-- CONFIG SPECIAL -->
      <section class="tab" id="tab-cfg-special">
        <div class="cfg-c" style="margin-bottom:16px">
          <div class="cfg-t">â­ Má»‡nh giÃ¡ Ä‘áº·c biá»‡t (áº©n vá»›i ngÆ°á»i chÆ¡i)</div>
          <p style="font-size:.82rem;color:var(--txt2);margin-bottom:18px;line-height:1.7">NgÆ°á»i chÆ¡i tháº¥y má»‡nh giÃ¡ bÃ¬nh thÆ°á»ng. Khi má»Ÿ Ã´ Ä‘áº·c biá»‡t sáº½ Ä‘Æ°á»£c hÆ°á»›ng dáº«n Ä‘áº¿n Admin Ä‘á»ƒ nháº­n giáº£i.</p>
          <div id="special-inputs"></div>
          <button class="ab ag" id="add-sp-btn">â• ThÃªm má»‡nh giÃ¡</button>
        </div>
        <div class="cfg-c" style="margin-bottom:16px">
          <div class="cfg-t">ğŸ”¢ Sá»‘ Ã´ Ä‘áº·c biá»‡t trong game</div>
          <div class="cfg-r"><span class="cfg-l">Sá»‘ lÆ°á»£ng Ã´ Ä‘áº·c biá»‡t</span><input type="number" class="inp" id="sp-count" min="1" max="10" value="2"/></div>
          <p style="font-size:.76rem;color:var(--txt3);margin-top:9px">KhÃ´ng nÃªn vÆ°á»£t quÃ¡ sá»‘ má»‡nh giÃ¡ Ä‘áº·c biá»‡t Ä‘Ã£ nháº­p.</p>
        </div>
        <button class="ab agr" id="save-sp-btn">ğŸ’¾ LÆ°u má»‡nh giÃ¡ Ä‘áº·c biá»‡t</button>
      </section>

      <!-- CONFIG GAME -->
      <section class="tab" id="tab-cfg-game">
        <div class="cfg-g">
          <div class="cfg-c">
            <div class="cfg-t">ğŸ® ThÃ´ng tin game</div>
            <div class="cfg-r"><span class="cfg-l">TiÃªu Ä‘á»</span><input type="text" class="inp inp-lg" id="g-title" value="LÃ¬ XÃ¬ Táº¿t 2025"/></div>
            <div class="cfg-r"><span class="cfg-l">Phá»¥ Ä‘á»</span><input type="text" class="inp inp-lg" id="g-sub" value="ChÃºc má»«ng nÄƒm má»›i"/></div>
            <div class="cfg-r"><span class="cfg-l">Sá»‘ confetti</span><input type="number" class="inp" id="g-conf" min="20" max="300" value="80"/></div>
          </div>
          <div class="cfg-c">
            <div class="cfg-t">ğŸ” TÃ i khoáº£n Admin</div>
            <div class="cfg-r"><span class="cfg-l">TÃªn Ä‘Äƒng nháº­p</span><input type="text" class="inp inp-lg" id="g-user" value="admin"/></div>
            <div class="cfg-r"><span class="cfg-l">Máº­t kháº©u má»›i</span><input type="password" class="inp inp-lg" id="g-pass" placeholder="Äá»ƒ trá»‘ng = giá»¯ nguyÃªn"/></div>
            <p style="font-size:.73rem;color:var(--txt3);margin-top:8px">âš  Thay Ä‘á»•i máº­t kháº©u cÃ³ hiá»‡u lá»±c ngay.</p>
          </div>
          <div class="cfg-c">
            <div class="cfg-t">ğŸ› TÃ­nh nÄƒng</div>
            <div class="tgr"><span class="tgl">Hiá»‡u á»©ng confetti</span><label class="sw"><input type="checkbox" id="f-conf" checked/><span class="sli"></span></label></div>
            <div class="tgr"><span class="tgl">Hoa rÆ¡i ná»n</span><label class="sw"><input type="checkbox" id="f-petal" checked/><span class="sli"></span></label></div>
            <div class="tgr"><span class="tgl">Gá»£i Ã½ Admin khi bá»‘c Ä‘áº·c biá»‡t</span><label class="sw"><input type="checkbox" id="f-hint" checked/><span class="sli"></span></label></div>
            <div class="tgr"><span class="tgl">Cho phÃ©p chÆ¡i láº¡i</span><label class="sw"><input type="checkbox" id="f-replay" checked/><span class="sli"></span></label></div>
          </div>
          <div class="cfg-c">
            <div class="cfg-t">ğŸ›  Há»‡ thá»‘ng</div>
            <button class="ab agr" onclick="applyGameCfg()">ğŸ’¾ LÆ°u cÃ i Ä‘áº·t</button>
            <button class="ab ar" id="reset-game-btn">ğŸ”„ Äáº·t láº¡i game</button>
            <button class="ab ag" onclick="document.getElementById('export-btn').click()">ğŸ“¥ Xuáº¥t CSV</button>
            <button class="ab ar" onclick="if(confirm('XÃ³a toÃ n bá»™ lá»‹ch sá»­ events?')){localStorage.removeItem('lixi_events');toast('âœ“ ÄÃ£ xÃ³a lá»‹ch sá»­','s')}">ğŸ—‘ XÃ³a lá»‹ch sá»­ events</button>
            <button class="ab abl" onclick="window.open('/','_blank')">ğŸ§§ Trang ngÆ°á»i chÆ¡i</button>
          </div>
        </div>
      </section>

      <!-- ANALYTICS -->
      <section class="tab" id="tab-analytics">
        <div class="mg">
          <div class="mc2 gold"><span class="mc2-ico">ğŸ’°</span><div class="mc2-val" id="a-total-real">0k</div><div class="mc2-lbl">Tá»•ng thá»±c táº¿ Ä‘Ã£ phÃ¡t</div></div>
          <div class="mc2 green"><span class="mc2-ico">ğŸ“ˆ</span><div class="mc2-val" id="a-avg">0k</div><div class="mc2-lbl">Trung bÃ¬nh / lÃ¬ xÃ¬</div></div>
          <div class="mc2 blue"><span class="mc2-ico">ğŸ†</span><div class="mc2-val" id="a-max">0k</div><div class="mc2-lbl">Má»‡nh giÃ¡ cao nháº¥t Ä‘Ã£ má»Ÿ</div></div>
          <div class="mc2 purple"><span class="mc2-ico">ğŸ¯</span><div class="mc2-val" id="a-special-rate">0%</div><div class="mc2-lbl">Tá»‰ lá»‡ Ã´ Ä‘áº·c biá»‡t Ä‘Æ°á»£c má»Ÿ</div></div>
        </div>
        <div class="cg">
          <div class="cc"><div class="cc-t">ğŸ“Š PhÃ¢n phá»‘i má»‡nh giÃ¡ thá»±c</div><div id="a-dist"></div></div>
          <div class="cc"><div class="cc-t">ğŸ¯ Tá»‰ lá»‡ má»Ÿ theo loáº¡i</div><div id="a-type"></div></div>
        </div>
        <div class="tw">
          <div class="th"><div class="th-t">ğŸ“Š Thá»‘ng kÃª theo má»‡nh giÃ¡</div></div>
          <table class="dt"><thead><tr><th>Má»‡nh giÃ¡</th><th>Sá»‘ Ã´</th><th>ÄÃ£ má»Ÿ</th><th>Tá»‰ lá»‡</th><th>Tá»•ng tiá»n</th><th>Bar</th></tr></thead>
          <tbody id="stat-tbody"></tbody></table>
        </div>
      </section>

      <!-- LOG -->
      <section class="tab" id="tab-log">
        <div class="tw">
          <div class="th">
            <div class="th-t">ğŸ“‹ Lá»‹ch sá»­ bá»‘c</div>
            <div class="th-c">
              <select class="fs" id="log-filter">
                <option value="all">Táº¥t cáº£</option>
                <option value="special">Äáº·c biá»‡t</option>
                <option value="normal">ThÆ°á»ng</option>
              </select>
              <button class="ibtn" onclick="renderLog()" title="LÃ m má»›i">â†º</button>
            </div>
          </div>
          <table class="dt"><thead><tr><th>STT</th><th>Ã” #</th><th>Hiá»ƒn thá»‹</th><th>Thá»±c táº¿</th><th>Loáº¡i</th><th>Thá»i gian</th></tr></thead>
          <tbody id="log-tbody"></tbody></table>
        </div>
      </section>

      <!-- NOTIFICATIONS -->
      <section class="tab" id="tab-notify">
        <div class="live-feed">
          <div class="live-head">
            <div class="live-title">ğŸ”” ThÃ´ng bÃ¡o há»‡ thá»‘ng</div>
            <button class="ibtn" onclick="clearNotifs()">ğŸ—‘ XÃ³a táº¥t cáº£</button>
          </div>
          <div class="live-scroll" id="notif-list"><!-- JS --></div>
        </div>
        <div class="cfg-c">
          <div class="cfg-t">âš™ï¸ CÃ i Ä‘áº·t thÃ´ng bÃ¡o</div>
          <div class="tgr"><span class="tgl">ThÃ´ng bÃ¡o khi má»Ÿ Ã´ Ä‘áº·c biá»‡t</span><label class="sw"><input type="checkbox" id="n-special" checked/><span class="sli"></span></label></div>
          <div class="tgr"><span class="tgl">ThÃ´ng bÃ¡o khi bá»‘c háº¿t</span><label class="sw"><input type="checkbox" id="n-complete" checked/><span class="sli"></span></label></div>
          <div class="tgr"><span class="tgl">Ã‚m thanh thÃ´ng bÃ¡o</span><label class="sw"><input type="checkbox" id="n-sound"/><span class="sli"></span></label></div>
        </div>
      </section>

    </div><!-- /ca -->
    <div class="svb" id="svb">
      <span class="svb-hint">âš¡ CÃ³ thay Ä‘á»•i chÆ°a lÆ°u â€” Nháº¥n ChÆ¡i Láº¡i Ä‘á»ƒ Ã¡p dá»¥ng.</span>
      <div class="svb-acts">
        <button class="svbtn svbtn-d" id="discard-btn">Há»§y</button>
        <button class="svbtn svbtn-s" id="save-btn">ğŸ’¾ LÆ°u & Ãp dá»¥ng</button>
      </div>
    </div>
  </main>
</div>
<div class="toast" id="toast" role="status" aria-live="polite"></div>

<script>
'use strict';
// â”€â”€ CONSTANTS â”€â”€
const SK='lixi_config',GK='lixi_game_data',EK='lixi_events',AK='lixi_admin_s',NK='lixi_notifs';
const DEF={totalEnvelopes:20,title:'LÃ¬ XÃ¬ Táº¿t 2025',subtitle:'ChÃºc má»«ng nÄƒm má»›i Â· Váº¡n sá»± nhÆ° Ã½',distribution:{1:2,2:2,3:2,5:3,10:4,15:2,20:5},specialValues:[50,100],specialCount:2,confettiCount:80,adminUser:'admin',adminPass:'lixÃ¬2025',features:{confetti:true,petals:true,hint:true,replay:true}};
const DC={1:'#8888a0',2:'#7777a0',3:'#9b59b6',5:'#3498db',10:'#2980b9',15:'#e67e22',20:'#e74c3c',50:'#e74c3c',100:'#ffd700'};

// â”€â”€ STORAGE HELPERS â”€â”€
const lg=()=>{try{const r=localStorage.getItem(GK);return r?JSON.parse(r):[]}catch{return[]}};
const lc=()=>{try{const r=localStorage.getItem(SK);return r?Object.assign({},DEF,JSON.parse(r)):Object.assign({},DEF)}catch{return Object.assign({},DEF)}};
const lev=()=>{try{return JSON.parse(localStorage.getItem(EK)||'[]')}catch{return[]}};
const lno=()=>{try{return JSON.parse(localStorage.getItem(NK)||'[]')}catch{return[]}};
const sc2=c=>localStorage.setItem(SK,JSON.stringify(c));
const sg=d=>localStorage.setItem(GK,JSON.stringify(d));
const sno=n=>localStorage.setItem(NK,JSON.stringify(n));

// â”€â”€ AUTH â”€â”€
let AUSER='admin',APASS='lixÃ¬2025';
function loadCreds(){const c=lc();AUSER=c.adminUser||'admin';APASS=c.adminPass||'lixÃ¬2025'}
function checkSess(){return sessionStorage.getItem(AK)==='1'}
function saveSess(){sessionStorage.setItem(AK,'1')}
function clearSess(){sessionStorage.removeItem(AK)}

// â”€â”€ STATE â”€â”€
let gameData=[],prevLen=0,notifs=[],pollInt=null;

// â”€â”€ BOOT â”€â”€
document.addEventListener('DOMContentLoaded',()=>{
  loadCreds();
  if(checkSess())showApp();
  document.getElementById('lf').addEventListener('submit',e=>{
    e.preventDefault();
    const u=document.getElementById('lu').value.trim(),p=document.getElementById('lp').value;
    loadCreds();
    if(u===AUSER&&p===APASS){
      document.getElementById('lerr').textContent='';
      document.getElementById('ls').classList.add('hidden');
      saveSess();showApp();
    } else {
      const el=document.getElementById('lerr');el.textContent='âš  Sai tÃªn Ä‘Äƒng nháº­p hoáº·c máº­t kháº©u!';
      el.classList.remove('sh');void el.offsetWidth;el.classList.add('sh');
      document.getElementById('lp').value='';document.getElementById('lp').focus();
    }
  });
});

function showApp(){
  document.getElementById('app').classList.add('on');
  gameData=lg();notifs=lno();
  populateForms();renderAll();setupNav();setupControls();
  startRealtime();
}

// â”€â”€ REAL-TIME POLLING â”€â”€
function startRealtime(){
  clearInterval(pollInt);
  pollInt=setInterval(()=>{
    const newData=lg();
    const newEvs=lev();
    // Detect new opens
    const newOpens=newData.filter((e,i)=>e.opened&&gameData[i]&&!gameData[i].opened);
    if(newOpens.length>0){
      newOpens.forEach(e=>{
        addNotif({type:'OPEN',msg:`Ã” #${String(e.id).padStart(2,'0')} vá»«a Ä‘Æ°á»£c má»Ÿ â€” ${e.displayValue}k${e.isSpecial?' ğŸ”¥ (Äáº·c biá»‡t)':''}`,ts:e.openedAt||new Date().toISOString(),isSpecial:e.isSpecial});
      });
      gameData=newData;
      renderAll();
      updateLiveFeedUI(newEvs);
    } else {
      gameData=newData;
    }
    updateLiveMetrics(newEvs);
  },1500);

  // Also listen to storage events from OTHER tabs
  window.addEventListener('storage',e=>{
    if(e.key===GK||e.key===EK){
      gameData=lg();renderAll();updateLiveMetrics(lev());updateLiveFeedUI(lev());
    }
  });
}

// â”€â”€ NOTIFICATIONS â”€â”€
function addNotif(n){
  notifs.unshift({...n,id:Date.now(),read:false});
  notifs=notifs.slice(0,100);sno(notifs);
  updateNotifBadge();
  if(n.isSpecial){toast('ğŸ”¥ Ã” Ä‘áº·c biá»‡t vá»«a Ä‘Æ°á»£c má»Ÿ!','s')}
  renderNotifList();
}
function updateNotifBadge(){
  const unread=notifs.filter(n=>!n.read).length;
  const el=document.getElementById('nb-notif');if(el)el.textContent=unread||'';
}
function clearNotifs(){notifs=[];sno(notifs);renderNotifList();updateNotifBadge();toast('âœ“ ÄÃ£ xÃ³a thÃ´ng bÃ¡o','i')}
function renderNotifList(){
  const c=document.getElementById('notif-list');if(!c)return;
  if(!notifs.length){c.innerHTML='<div style="padding:24px;text-align:center;color:var(--txt3);font-size:.85rem">ChÆ°a cÃ³ thÃ´ng bÃ¡o</div>';return}
  c.innerHTML=notifs.map(n=>`<div class="live-item" onclick="markRead(${n.id})">
    <span class="li-ico">${n.isSpecial?'ğŸ”¥':'ğŸ§§'}</span>
    <div class="li-info"><div class="li-main" style="color:${n.read?'var(--txt2)':'var(--txt)'}">${n.msg}</div></div>
    <div class="li-time">${timeSince(n.ts)}</div>
  </div>`).join('');
}
function markRead(id){const n=notifs.find(x=>x.id===id);if(n)n.read=true;sno(notifs);updateNotifBadge();renderNotifList()}

// â”€â”€ LIVE FEED â”€â”€
function updateLiveFeedUI(evs){
  const c=document.getElementById('live-scroll');if(!c)return;
  const opens=evs.filter(e=>e.type==='OPEN').slice(0,50);
  if(!opens.length){c.innerHTML='<div style="padding:22px;text-align:center;color:var(--txt3);font-size:.85rem">ChÆ°a cÃ³ sá»± kiá»‡n nÃ o...</div>';return}
  c.innerHTML=opens.map(ev=>`<div class="live-item">
    <span class="li-ico">${ev.isSpecial?'ğŸ”¥':'ğŸ§§'}</span>
    <div class="li-info">
      <div class="li-main">Ã” #${String(ev.envelopeId).padStart(2,'0')} Ä‘Æ°á»£c má»Ÿ${ev.isSpecial?' <span style="color:var(--red2)">Â· Äáº¶C BIá»†T</span>':''}</div>
      <div class="li-sub">Hiá»ƒn thá»‹: ${ev.displayValue}k Â· Thá»±c táº¿: ${ev.realValue}k</div>
    </div>
    <div style="text-align:right">
      <div class="li-val" style="color:${ev.isSpecial?'var(--gold3)':'var(--txt)'}">${ev.displayValue}k</div>
      <div class="li-time">${timeSince(ev.ts)}</div>
    </div>
  </div>`).join('');
  document.getElementById('nb-live').textContent=opens.length;
}

function updateLiveMetrics(evs){
  const opens=evs.filter(e=>e.type==='OPEN');
  const el=id=>{const e=document.getElementById(id);return e};
  if(el('lf-opened'))el('lf-opened').textContent=opens.length;
  if(opens.length&&el('lf-last')){
    const last=opens[0];el('lf-last').textContent=timeSince(last.ts);
  }
  // Rate: opens in last 5 min
  const now=Date.now();const recent=opens.filter(e=>now-new Date(e.ts).getTime()<300000);
  if(el('lf-rate'))el('lf-rate').textContent=recent.length+'/5ph';
  renderHourlyChart(opens);
}

function renderHourlyChart(opens){
  const c=document.getElementById('hourly-chart');if(!c)return;
  const hours={};opens.forEach(e=>{const h=new Date(e.ts).getHours();hours[h]=(hours[h]||0)+1});
  if(!Object.keys(hours).length){c.innerHTML='<p style="color:var(--txt3);font-size:.83rem;text-align:center;padding:12px">ChÆ°a cÃ³ dá»¯ liá»‡u</p>';return}
  const mx=Math.max(...Object.values(hours),1);
  c.innerHTML=Object.entries(hours).sort((a,b)=>Number(a[0])-Number(b[0])).map(([h,cnt])=>`
    <div class="brow"><div class="blr"><span class="blt">${String(h).padStart(2,'0')}:00</span><span class="blv">${cnt} lÆ°á»£t</span></div>
    <div class="btr"><div class="bf" style="width:${cnt/mx*100}%;background:linear-gradient(90deg,var(--red),var(--gold))"></div></div></div>
  `).join('');
}

// â”€â”€ RENDER ALL â”€â”€
function renderAll(){
  renderMetrics();renderEnvTable();renderSpecialCards();renderCharts();
}

// â”€â”€ METRICS â”€â”€
const METRIC_DEFS=[
  {id:'m-total',ico:'ğŸ§§',color:'gold',label:'Tá»•ng sá»‘ Ã´',sub:'Cá»‘ Ä‘á»‹nh',fn:d=>d.length||lc().totalEnvelopes},
  {id:'m-opened',ico:'âœ…',color:'green',label:'ÄÃ£ má»Ÿ',fn:d=>d.filter(e=>e.opened).length},
  {id:'m-pending',ico:'â³',color:'blue',label:'ChÆ°a má»Ÿ',fn:d=>d.filter(e=>!e.opened).length},
  {id:'m-spec',ico:'â­',color:'red',label:'Ã” Ä‘áº·c biá»‡t',fn:d=>{const s=d.filter(e=>e.isSpecial);return s.filter(e=>e.opened).length+'/'+s.length}},
  {id:'m-real',ico:'ğŸ’°',color:'gold',label:'Tá»•ng thá»±c táº¿',fn:d=>d.filter(e=>e.opened).reduce((s,e)=>s+e.realValue,0)+'k'},
  {id:'m-pct',ico:'ğŸ“Š',color:'purple',label:'Tiáº¿n Ä‘á»™',fn:d=>Math.round(d.filter(e=>e.opened).length/Math.max(d.length,1)*100)+'%'},
  {id:'m-disp',ico:'ğŸ’µ',color:'teal',label:'Tá»•ng hiá»ƒn thá»‹',fn:d=>d.filter(e=>e.opened).reduce((s,e)=>s+e.displayValue,0)+'k'},
];
function renderMetrics(){
  const g=document.getElementById('metrics-grid');if(!g)return;
  // First time: build cards
  if(!g.children.length){
    g.innerHTML=METRIC_DEFS.map(m=>`<div class="mc2 ${m.color}" id="card-${m.id}"><span class="mc2-ico">${m.ico}</span><div class="mc2-val" id="${m.id}">â€”</div><div class="mc2-lbl">${m.label}</div>${m.sub?`<span class="mc2-sub">${m.sub}</span>`:''}</div>`).join('');
  }
  METRIC_DEFS.forEach(m=>{const el=document.getElementById(m.id);if(el)el.textContent=m.fn(gameData)});
  document.getElementById('nb-spec').textContent=gameData.filter(e=>e.isSpecial).length;
}

// â”€â”€ ENV TABLE â”€â”€
function renderEnvTable(fv='all',sv=''){
  const tb=document.getElementById('env-tbody');if(!tb)return;tb.innerHTML='';
  let d=[...gameData];
  if(fv==='opened')d=d.filter(e=>e.opened);
  if(fv==='pending')d=d.filter(e=>!e.opened);
  if(fv==='special')d=d.filter(e=>e.isSpecial);
  if(sv){const s=sv.toLowerCase();d=d.filter(e=>String(e.id).includes(s)||String(e.displayValue).includes(s)||String(e.realValue).includes(s))}
  if(!d.length){tb.innerHTML='<tr><td colspan="7" style="text-align:center;color:var(--txt3);padding:26px">KhÃ´ng cÃ³ dá»¯ liá»‡u</td></tr>';return}
  d.forEach(env=>{const tr=document.createElement('tr');
    tr.innerHTML=`<td style="font-family:'JetBrains Mono',monospace;color:var(--txt)">#${String(env.id).padStart(2,'0')}</td>
    <td><span class="badge ${env.isSpecial?'bs':'bn'}">${env.isSpecial?'ğŸ”¥ Äáº·c biá»‡t':'ğŸ“¦ ThÆ°á»ng'}</span></td>
    <td style="font-family:'JetBrains Mono',monospace">${env.displayValue}k</td>
    <td style="font-family:'JetBrains Mono',monospace;color:${env.isSpecial?'var(--gold3)':'var(--txt2)'}">${env.realValue}k${env.isSpecial?' â­':''}</td>
    <td><span class="badge ${env.opened?'bo':'bp'}">${env.opened?'âœ“ ÄÃ£ má»Ÿ':'â—‹ Chá»'}</span></td>
    <td style="font-size:.76rem;color:var(--txt3)">${env.openedAt?new Date(env.openedAt).toLocaleString('vi-VN'):'â€”'}</td>
    <td><button class="ibtn" onclick="toggleEnv(${env.id-1})" title="${env.opened?'Äáº·t láº¡i':'ÄÃ¡nh dáº¥u Ä‘Ã£ má»Ÿ'}">${env.opened?'â†º':'âœ“'}</button></td>`;
    tb.appendChild(tr);
  });
}
window.toggleEnv=function(i){
  if(i<0||i>=gameData.length)return;
  gameData[i].opened=!gameData[i].opened;gameData[i].openedAt=gameData[i].opened?new Date().toISOString():null;
  sg(gameData);renderAll();toast(`${gameData[i].opened?'âœ“ ÄÃ£ má»Ÿ':'â†º Äáº·t láº¡i'} Ã´ #${String(gameData[i].id).padStart(2,'0')}`,'s');
};

// â”€â”€ SPECIAL CARDS â”€â”€
function renderSpecialCards(){
  const c=document.getElementById('sp-cards');if(!c)return;c.innerHTML='';
  const sp=gameData.filter(e=>e.isSpecial);
  if(!sp.length){c.innerHTML='<p style="color:var(--txt3);font-size:.85rem">ChÆ°a cÃ³ dá»¯ liá»‡u. NgÆ°á»i chÆ¡i cáº§n khá»Ÿi Ä‘á»™ng game.</p>';return}
  sp.forEach(env=>{const card=document.createElement('div');card.className='sp-c';
    card.innerHTML=`<div class="sp-n">Ã” #${String(env.id).padStart(2,'0')}</div>
    <div class="sp-d">Hiá»ƒn thá»‹: ${env.displayValue}k</div>
    <div class="sp-r">${env.realValue}k ğŸ†</div>
    <div class="sp-s"><span class="badge ${env.opened?'bo':'bp'}">${env.opened?'âœ“ ÄÃ£ Ä‘Æ°á»£c bá»‘c':'â—‹ ChÆ°a má»Ÿ'}</span></div>`;
    c.appendChild(card);
  });
}

// â”€â”€ CHARTS â”€â”€
function renderCharts(){
  // Distribution
  const dist={};gameData.forEach(e=>{dist[e.realValue]=(dist[e.realValue]||0)+1});
  const dEl=document.getElementById('c-dist');if(dEl){
    const mx=Math.max(...Object.values(dist),1);dEl.innerHTML='';
    Object.entries(dist).sort((a,b)=>Number(a[0])-Number(b[0])).forEach(([v,c])=>{
      const pct=Math.round(c/gameData.length*100);
      const row=document.createElement('div');row.className='brow';
      row.innerHTML=`<div class="blr"><span class="blt">${v}k</span><span class="blv">${c} Ã´ (${pct}%)</span></div><div class="btr"><div class="bf" style="width:0%;background:${DC[v]||'#8888a0'}" data-w="${c/mx*100}"></div></div>`;
      dEl.appendChild(row);
    });
  }
  // Progress
  const op=gameData.filter(e=>e.opened).length,tot=Math.max(gameData.length,1);
  const pEl=document.getElementById('c-prog');if(pEl){
    pEl.innerHTML=`<div class="brow"><div class="blr"><span class="blt">ÄÃ£ má»Ÿ</span><span class="blv">${op} Ã´ (${Math.round(op/tot*100)}%)</span></div><div class="btr"><div class="bf" style="width:0%;background:linear-gradient(90deg,#27ae60,#2ecc71)" data-w="${op/tot*100}"></div></div></div>
    <div class="brow"><div class="blr"><span class="blt">ChÆ°a má»Ÿ</span><span class="blv">${tot-op} Ã´</span></div><div class="btr"><div class="bf" style="width:0%;background:linear-gradient(90deg,var(--gold),var(--gold2))" data-w="${(tot-op)/tot*100}"></div></div></div>
    <div class="brow"><div class="blr"><span class="blt">Äáº·c biá»‡t Ä‘Ã£ má»Ÿ</span><span class="blv">${gameData.filter(e=>e.isSpecial&&e.opened).length} Ã´</span></div><div class="btr"><div class="bf" style="width:0%;background:linear-gradient(90deg,var(--red),var(--red2))" data-w="${gameData.filter(e=>e.isSpecial&&e.opened).length/Math.max(gameData.filter(e=>e.isSpecial).length,1)*100}"></div></div></div>`;
  }
  setTimeout(()=>document.querySelectorAll('.bf[data-w]').forEach(el=>{el.style.width=el.dataset.w+'%'}),100);
}

// â”€â”€ ANALYTICS â”€â”€
function renderAnalytics(){
  const op=gameData.filter(e=>e.opened);
  const totR=op.reduce((s,e)=>s+e.realValue,0);
  const avg=op.length?Math.round(totR/op.length):0;
  const maxV=op.length?Math.max(...op.map(e=>e.realValue)):0;
  const spAll=gameData.filter(e=>e.isSpecial);
  const spOp=spAll.filter(e=>e.opened);
  const s=id=>document.getElementById(id);
  if(s('a-total-real'))s('a-total-real').textContent=totR+'k';
  if(s('a-avg'))s('a-avg').textContent=avg+'k';
  if(s('a-max'))s('a-max').textContent=maxV+'k';
  if(s('a-special-rate'))s('a-special-rate').textContent=(spAll.length?Math.round(spOp.length/spAll.length*100):0)+'%';
  // Dist chart
  const dist={};gameData.forEach(e=>{dist[e.realValue]=(dist[e.realValue]||0)+1});
  const mx=Math.max(...Object.values(dist),1);
  const ad=s('a-dist');if(ad){ad.innerHTML='';Object.entries(dist).sort((a,b)=>Number(a[0])-Number(b[0])).forEach(([v,c])=>{const row=document.createElement('div');row.className='brow';row.innerHTML=`<div class="blr"><span class="blt">${v}k</span><span class="blv">${c} Ã´</span></div><div class="btr"><div class="bf" style="width:${c/mx*100}%;background:${DC[v]||'#8888a0'}"></div></div>`;ad.appendChild(row)})}
  // Type chart
  const at=s('a-type');if(at){
    const norm=gameData.filter(e=>!e.isSpecial).length,spec=gameData.filter(e=>e.isSpecial).length,tot2=Math.max(gameData.length,1);
    at.innerHTML=`<div class="brow"><div class="blr"><span class="blt">ThÆ°á»ng</span><span class="blv">${norm} Ã´ (${Math.round(norm/tot2*100)}%)</span></div><div class="btr"><div class="bf" style="width:${norm/tot2*100}%;background:var(--blue)"></div></div></div>
    <div class="brow"><div class="blr"><span class="blt">Äáº·c biá»‡t</span><span class="blv">${spec} Ã´ (${Math.round(spec/tot2*100)}%)</span></div><div class="btr"><div class="bf" style="width:${spec/tot2*100}%;background:var(--red2)"></div></div></div>`;
  }
  // Stat table
  const tb=s('stat-tbody');if(tb){tb.innerHTML='';
    Object.entries(dist).sort((a,b)=>Number(a[0])-Number(b[0])).forEach(([v,d])=>{
      const opd=gameData.filter(e=>e.realValue==v&&e.opened).length;const pct=Math.round(opd/d*100);
      const tr=document.createElement('tr');tr.innerHTML=`<td style="font-family:'JetBrains Mono',monospace;color:var(--gold3)">${v}k</td><td>${d}</td><td>${opd}</td><td><div style="display:flex;align-items:center;gap:6px"><div style="width:70px;height:5px;background:rgba(255,255,255,.05);border-radius:3px;overflow:hidden"><div style="width:${pct}%;height:100%;background:var(--green)"></div></div><span style="font-size:.76rem">${pct}%</span></div></td><td style="font-family:'JetBrains Mono',monospace">${v*opd}k</td><td><span class="badge ${pct>=80?'bo':pct>=40?'bp':'bn'}">${pct>=80?'Nhiá»u':pct>=40?'Trung bÃ¬nh':'Ãt'}</span></td>`;
      tb.appendChild(tr);
    });
  }
}

// â”€â”€ LOG â”€â”€
function renderLog(){
  const fv=document.getElementById('log-filter')?.value||'all';
  const tb=document.getElementById('log-tbody');if(!tb)return;
  let opens=gameData.filter(e=>e.opened&&e.openedAt).sort((a,b)=>new Date(b.openedAt)-new Date(a.openedAt));
  if(fv==='special')opens=opens.filter(e=>e.isSpecial);
  if(fv==='normal')opens=opens.filter(e=>!e.isSpecial);
  tb.innerHTML=opens.map((e,i)=>`<tr>
    <td style="color:var(--txt3)">${i+1}</td>
    <td style="font-family:'JetBrains Mono',monospace;color:var(--txt)">#${String(e.id).padStart(2,'0')}</td>
    <td style="font-family:'JetBrains Mono',monospace">${e.displayValue}k</td>
    <td style="font-family:'JetBrains Mono',monospace;color:${e.isSpecial?'var(--gold3)':'var(--txt2)'}">${e.realValue}k${e.isSpecial?' â­':''}</td>
    <td><span class="badge ${e.isSpecial?'bs':'bn'}">${e.isSpecial?'ğŸ”¥ Äáº·c biá»‡t':'ğŸ“¦ ThÆ°á»ng'}</span></td>
    <td style="font-size:.76rem;color:var(--txt3)">${new Date(e.openedAt).toLocaleString('vi-VN')}</td>
  </tr>`).join('');
  if(!opens.length)tb.innerHTML='<tr><td colspan="6" style="text-align:center;color:var(--txt3);padding:26px">ChÆ°a cÃ³ lá»‹ch sá»­</td></tr>';
}

// â”€â”€ CONFIG FORMS â”€â”€
const RATIO_VALS=[1,2,3,5,10,15,20];
let ratioState={};
function populateForms(){
  const c=lc();
  RATIO_VALS.forEach(v=>{ratioState[v]=c.distribution[v]||0});
  renderRatioTable();renderSpecialInputs(c.specialValues||[50,100]);
  document.getElementById('sp-count').value=c.specialCount||2;
  document.getElementById('g-title').value=c.title||DEF.title;
  document.getElementById('g-sub').value=c.subtitle||DEF.subtitle;
  document.getElementById('g-conf').value=c.confettiCount||80;
  document.getElementById('g-user').value=c.adminUser||'admin';
  const f=c.features||DEF.features;
  document.getElementById('f-conf').checked=f.confetti!==false;
  document.getElementById('f-petal').checked=f.petals!==false;
  document.getElementById('f-hint').checked=f.hint!==false;
  document.getElementById('f-replay').checked=f.replay!==false;
}
function renderRatioTable(){
  const tbl=document.getElementById('ratio-tbl');if(!tbl)return;tbl.innerHTML='';
  let tot=0;Object.values(ratioState).forEach(v=>tot+=v);
  RATIO_VALS.forEach(val=>{const qty=ratioState[val]||0;const pct=tot>0?Math.round(qty/tot*100):0;
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="rl">${val}k</td><td style="padding:7px"><input type="range" min="0" max="20" value="${qty}" oninput="updateRatio(${val},this.value)"/></td><td class="rn" id="rn${val}">${qty}</td><td class="rp" id="rp${val}">${pct}%</td>`;
    tbl.appendChild(tr);
  });
  document.getElementById('ratio-tot').textContent=tot;
  renderRatioPreview();
}
function updateRatio(val,qty){
  ratioState[val]=parseInt(qty)||0;
  let tot=0;Object.values(ratioState).forEach(v=>tot+=v);
  const n=document.getElementById('rn'+val);if(n)n.textContent=qty;
  RATIO_VALS.forEach(v=>{const p=document.getElementById('rp'+v);if(p)p.textContent=(tot>0?Math.round((ratioState[v]||0)/tot*100):0)+'%'});
  document.getElementById('ratio-tot').textContent=tot;
  renderRatioPreview();markDirty();
}
function renderRatioPreview(){
  const c=document.getElementById('ratio-preview');if(!c)return;
  let tot=0;Object.values(ratioState).forEach(v=>tot+=v);
  if(!tot){c.innerHTML='<p style="color:var(--txt3);font-size:.83rem">Táº¥t cáº£ Ä‘á»u báº±ng 0</p>';return}
  c.innerHTML=RATIO_VALS.filter(v=>ratioState[v]>0).map(val=>{
    const qty=ratioState[val],pct=qty/tot*100;
    return`<div class="brow"><div class="blr"><span class="blt">${val}k</span><span class="blv">${qty} Ã´ Â· ${Math.round(pct)}%</span></div><div class="btr"><div class="bf" style="width:${pct}%;background:${DC[val]||'#8888a0'}"></div></div></div>`;
  }).join('');
}
function saveRatioCfg(){
  let tot=0;Object.values(ratioState).forEach(v=>tot+=v);
  if(!tot){toast('âš  Tá»•ng sá»‘ Ã´ pháº£i > 0','e');return}
  const c=lc();c.distribution={...ratioState};c.totalEnvelopes=tot;sc2(c);
  toast('âœ“ ÄÃ£ lÆ°u tá»‰ lá»‡! Nháº¥n ChÆ¡i Láº¡i Ä‘á»ƒ Ã¡p dá»¥ng.','s');hideSaveBar();
}
// Special
let spList=[50,100];
function renderSpecialInputs(vals){
  spList=[...vals];const c=document.getElementById('special-inputs');if(!c)return;c.innerHTML='';
  spList.forEach((v,i)=>{
    const row=document.createElement('div');row.className='cfg-r';
    row.innerHTML=`<span class="cfg-l">Má»‡nh giÃ¡ Ä‘áº·c biá»‡t #${i+1}</span><div style="display:flex;gap:7px;align-items:center"><input type="number" class="inp" value="${v}" min="1" max="9999" onchange="spList[${i}]=parseInt(this.value)||0;markDirty()"/><button class="ibtn" style="color:var(--red2);flex-shrink:0" onclick="spList.splice(${i},1);renderSpecialInputs(spList);markDirty()" title="XÃ³a">âœ•</button></div>`;
    c.appendChild(row);
  });
}
document.getElementById('add-sp-btn')?.addEventListener('click',()=>{spList.push(50);renderSpecialInputs(spList);markDirty()});
function saveSpCfg(){
  const c=lc();c.specialValues=spList.filter(v=>v>0);c.specialCount=parseInt(document.getElementById('sp-count').value)||2;
  sc2(c);toast('âœ“ ÄÃ£ lÆ°u má»‡nh giÃ¡ Ä‘áº·c biá»‡t!','s');hideSaveBar();
}
function applyGameCfg(){
  const c=lc();
  c.title=document.getElementById('g-title').value||DEF.title;
  c.subtitle=document.getElementById('g-sub').value||DEF.subtitle;
  c.confettiCount=parseInt(document.getElementById('g-conf').value)||80;
  c.adminUser=document.getElementById('g-user').value||'admin';
  const np=document.getElementById('g-pass').value;if(np){c.adminPass=np}
  c.features={confetti:document.getElementById('f-conf').checked,petals:document.getElementById('f-petal').checked,hint:document.getElementById('f-hint').checked,replay:document.getElementById('f-replay').checked};
  sc2(c);loadCreds();toast('âœ“ ÄÃ£ lÆ°u cÃ i Ä‘áº·t game!','s');hideSaveBar();
}
// Dirty / save bar
let dirty=false;
function markDirty(){dirty=true;document.getElementById('svb').classList.add('show')}
function hideSaveBar(){dirty=false;document.getElementById('svb').classList.remove('show')}
document.getElementById('save-btn')?.addEventListener('click',()=>{
  const active=document.querySelector('.tab.on');if(!active)return;
  if(active.id==='tab-cfg-ratio')saveRatioCfg();
  else if(active.id==='tab-cfg-special')saveSpCfg();
  else applyGameCfg();
});
document.getElementById('discard-btn')?.addEventListener('click',()=>{hideSaveBar();populateForms()});

// â”€â”€ NAV â”€â”€
function setupNav(){
  document.querySelectorAll('[data-tab]').forEach(btn=>{
    btn.addEventListener('click',()=>{
      document.querySelectorAll('[data-tab]').forEach(b=>b.classList.remove('active'));btn.classList.add('active');
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('on'));
      const t=document.getElementById('tab-'+btn.dataset.tab);if(t)t.classList.add('on');
      document.getElementById('tb-tit').textContent=btn.querySelector('.nlbl')?.textContent||'Dashboard';
      const tab=btn.dataset.tab;
      if(tab==='live'){updateLiveFeedUI(lev());updateLiveMetrics(lev())}
      if(tab==='analytics')renderAnalytics();
      if(tab==='log')renderLog();
      if(tab==='notify'){renderNotifList();notifs.forEach(n=>n.read=true);sno(notifs);updateNotifBadge()}
    });
  });
}

// â”€â”€ CONTROLS â”€â”€
function setupControls(){
  document.getElementById('env-search')?.addEventListener('input',function(){renderEnvTable(document.getElementById('env-filter').value,this.value)});
  document.getElementById('env-filter')?.addEventListener('change',function(){renderEnvTable(this.value,document.getElementById('env-search').value)});
  document.getElementById('log-filter')?.addEventListener('change',renderLog);
  document.getElementById('logout-btn')?.addEventListener('click',()=>{clearSess();clearInterval(pollInt);window.location.reload()});
  document.getElementById('refresh-btn')?.addEventListener('click',()=>{gameData=lg();renderAll();updateLiveMetrics(lev());toast('â†º ÄÃ£ lÃ m má»›i','i')});
  document.getElementById('export-btn')?.addEventListener('click',exportCSV);
  document.getElementById('reset-game-btn')?.addEventListener('click',()=>{
    if(confirm('Äáº·t láº¡i toÃ n bá»™ game? Táº¥t cáº£ Ã´ vá» chÆ°a má»Ÿ.')){
      gameData.forEach(e=>{e.opened=false;e.openedAt=null});sg(gameData);renderAll();
      addNotif({type:'RESET',msg:'Admin Ä‘Ã£ Ä‘áº·t láº¡i toÃ n bá»™ game',ts:new Date().toISOString()});
      toast('âœ“ ÄÃ£ Ä‘áº·t láº¡i game','s');
    }
  });
  document.getElementById('save-ratio-btn')?.addEventListener('click',saveRatioCfg);
  document.getElementById('save-sp-btn')?.addEventListener('click',saveSpCfg);
  ['g-title','g-sub','g-conf','g-user','g-pass','f-conf','f-petal','f-hint','f-replay'].forEach(id=>{document.getElementById(id)?.addEventListener('change',markDirty)});
}
window.clearEvents=function(){if(confirm('XÃ³a toÃ n bá»™ live events?')){localStorage.removeItem(EK);updateLiveFeedUI([]);toast('âœ“ ÄÃ£ xÃ³a events','i')}};

// â”€â”€ EXPORT â”€â”€
function exportCSV(){
  const h=['ID','Loáº¡i','Hiá»ƒn thá»‹','Thá»±c táº¿','Tráº¡ng thÃ¡i','Thá»i gian'];
  const rows=gameData.map(e=>['#'+String(e.id).padStart(2,'0'),e.isSpecial?'Äáº·c biá»‡t':'ThÆ°á»ng',e.displayValue+'k',e.realValue+'k',e.opened?'ÄÃ£ má»Ÿ':'ChÆ°a má»Ÿ',e.openedAt?new Date(e.openedAt).toLocaleString('vi-VN'):'â€”']);
  const csv=[h,...rows].map(r=>r.join(',')).join('\n');
  const a=document.createElement('a');a.href=URL.createObjectURL(new Blob(['\ufeff'+csv],{type:'text/csv;charset=utf-8'}));a.download=`lixi-${new Date().toLocaleDateString('vi-VN').replaceAll('/','-')}.csv`;a.click();toast('ğŸ“¥ ÄÃ£ xuáº¥t CSV','s');
}

// â”€â”€ UTILS â”€â”€
function timeSince(ts){
  const d=Math.floor((Date.now()-new Date(ts).getTime())/1000);
  if(d<5)return'Vá»«a xong';if(d<60)return d+'s trÆ°á»›c';if(d<3600)return Math.floor(d/60)+'ph trÆ°á»›c';
  if(d<86400)return Math.floor(d/3600)+'h trÆ°á»›c';return new Date(ts).toLocaleTimeString('vi-VN');
}
const toastEl=document.getElementById('toast');let toastT;
function toast(msg,t='i'){if(!toastEl)return;toastEl.textContent=msg;toastEl.className='toast '+t+' show';clearTimeout(toastT);toastT=setTimeout(()=>toastEl.classList.remove('show'),3000)}
</script>
</body>
</html>
